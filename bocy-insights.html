<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>BOCY Insights ‚Äî See Your Financial Optimisation</title>
    <meta name="description" content="Get instant financial insights. See exactly how to optimise your money with transparent calculations.">
    <meta name="theme-color" content="#000000">
    <link rel="canonical" href="https://bocy.io/insights">
    
    <meta property="og:title" content="BOCY Insights ‚Äî See Your Financial Optimisation">
    <meta property="og:description" content="Get instant financial insights. See exactly how to optimise your money.">
    <meta property="og:image" content="https://bocy.io/og-image.png">
    
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        :root {
            --bg: #000; --bg-elevated: #0A0A0A; --bg-subtle: #111; --bg-muted: #161616;
            --bg-card: #0D0D0D;
            --text: #FFF; --text-secondary: #A1A1A1; --text-muted: #666;
            --accent: #00D4AA; --accent-hover: #00E8BB; --accent-dim: rgba(0,212,170,0.1);
            --blue: #4D9FFF; --purple: #A855F7; --coral: #FF6B6B; --teal: #2DD4BF;
            --yellow: #FBBF24; --orange: #F97316;
            --border: rgba(255,255,255,0.08); --border-hover: rgba(255,255,255,0.15);
            --font-mono: 'JetBrains Mono', monospace;
        }
        
        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', -apple-system, sans-serif;
            font-size: 16px; line-height: 1.5;
            color: var(--text); background: var(--bg);
            -webkit-font-smoothing: antialiased;
            min-height: 100vh;
        }
        
        #root { min-height: 100vh; }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-6px); }
        }
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(0,212,170,0.3); }
            50% { box-shadow: 0 0 40px rgba(0,212,170,0.5); }
        }
        
        .fade-in { animation: fadeIn 0.5s ease forwards; }
        .slide-in { animation: slideIn 0.4s ease forwards; }
        .scale-in { animation: scaleIn 0.3s ease forwards; }
        
        /* Dot background */
        .dot-field {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            pointer-events: none; z-index: 0; overflow: hidden;
        }
        .dot {
            position: absolute; width: 2px; height: 2px;
            background: rgba(255,255,255,0.1); border-radius: 50%;
            animation: drift 25s infinite linear;
        }
        .dot:nth-child(3n) { background: rgba(0,212,170,0.08); }
        @keyframes drift {
            0% { transform: translateY(100vh); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100vh); opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="dot-field" aria-hidden="true">
        <div class="dot" style="left:5%;animation-delay:0s"></div>
        <div class="dot" style="left:15%;animation-delay:2s"></div>
        <div class="dot" style="left:25%;animation-delay:4s"></div>
        <div class="dot" style="left:35%;animation-delay:1s"></div>
        <div class="dot" style="left:45%;animation-delay:3s"></div>
        <div class="dot" style="left:55%;animation-delay:5s"></div>
        <div class="dot" style="left:65%;animation-delay:2.5s"></div>
        <div class="dot" style="left:75%;animation-delay:4.5s"></div>
        <div class="dot" style="left:85%;animation-delay:1.5s"></div>
        <div class="dot" style="left:95%;animation-delay:3.5s"></div>
    </div>
    
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;
        
        // ==================== DEMO DATA ====================
        const DEMO_DATA = {
            income: 3200,
            bills: {
                rent: 950,
                utilities: 120,
                phone: 45,
                subscriptions: 85,
                insurance: 80,
                transport: 150,
                groceries: 320,
                other: 100
            },
            debts: [
                { name: 'Credit Card', balance: 2400, apr: 18.9, minPayment: 65 },
                { name: 'Overdraft', balance: 500, apr: 39.9, minPayment: 0 }
            ],
            savings: {
                currentAccount: 450,
                savingsAccount: 1200,
                savingsRate: 4.5
            }
        };
        
        // Best UK savings rates for comparison
        const UK_SAVINGS_RATES = [
            { name: 'Chip', rate: 4.84, type: 'Easy Access' },
            { name: 'Chase', rate: 3.5, type: 'Easy Access' },
            { name: 'Moneybox', rate: 5.0, type: '90-Day Notice' },
            { name: 'Zopa', rate: 4.85, type: 'Easy Access' },
        ];
        
        // ==================== UTILITIES ====================
        const formatCurrency = (amount) => {
            return new Intl.NumberFormat('en-GB', { 
                style: 'currency', 
                currency: 'GBP',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        };
        
        const formatPercent = (value) => `${value.toFixed(1)}%`;
        
        // ==================== CALCULATION ENGINE ====================
        const calculateInsights = (data) => {
            // Total bills
            const totalBills = Object.values(data.bills).reduce((a, b) => a + b, 0);
            
            // Total debt minimum payments
            const totalMinPayments = data.debts.reduce((a, d) => a + d.minPayment, 0);
            
            // Monthly surplus
            const surplus = data.income - totalBills - totalMinPayments;
            
            // Total debt
            const totalDebt = data.debts.reduce((a, d) => a + d.balance, 0);
            
            // Total savings
            const totalSavings = data.savings.currentAccount + data.savings.savingsAccount;
            
            // Emergency fund calculation (3 months of expenses)
            const monthlyExpenses = totalBills + totalMinPayments;
            const emergencyFundTarget = monthlyExpenses * 3;
            const emergencyFundGap = Math.max(0, emergencyFundTarget - totalSavings);
            const emergencyFundMonths = totalSavings / monthlyExpenses;
            
            // Debt optimisation - calculate interest saved by paying extra
            const debtInsights = data.debts.map(debt => {
                const monthlyInterest = (debt.balance * (debt.apr / 100)) / 12;
                const annualInterest = debt.balance * (debt.apr / 100);
                
                // If we put surplus towards this debt
                const monthsToPayOff = debt.balance / (surplus > 0 ? surplus : 100);
                const interestSavedIfPaidNow = annualInterest;
                
                return {
                    ...debt,
                    monthlyInterest,
                    annualInterest,
                    monthsToPayOff: Math.ceil(monthsToPayOff),
                    interestSavedIfPaidNow
                };
            }).sort((a, b) => b.apr - a.apr); // Highest APR first
            
            // Savings rate comparison
            const currentRate = data.savings.savingsRate;
            const bestRate = Math.max(...UK_SAVINGS_RATES.map(r => r.rate));
            const rateDifference = bestRate - currentRate;
            const potentialExtraInterest = (data.savings.savingsAccount * rateDifference) / 100;
            
            // Optimal allocation recommendation
            let recommendation = {};
            const highestAprDebt = debtInsights[0];
            
            if (surplus <= 0) {
                recommendation = {
                    type: 'warning',
                    title: 'You\'re spending more than you earn',
                    action: 'Review your bills to find savings',
                    reasoning: `Your expenses (${formatCurrency(monthlyExpenses)}) exceed your income by ${formatCurrency(Math.abs(surplus))}/month.`
                };
            } else if (emergencyFundMonths < 1) {
                // Priority: Build emergency fund
                const toEmergency = Math.min(surplus, emergencyFundTarget - totalSavings);
                recommendation = {
                    type: 'emergency',
                    title: 'Build your safety net first',
                    action: `Save ${formatCurrency(toEmergency)} to emergency fund`,
                    reasoning: `You only have ${emergencyFundMonths.toFixed(1)} months of expenses saved. Aim for 3 months (${formatCurrency(emergencyFundTarget)}) before aggressive debt payoff.`,
                    allocation: { emergency: toEmergency, debt: surplus - toEmergency }
                };
            } else if (highestAprDebt && highestAprDebt.apr > currentRate) {
                // Priority: Pay high-interest debt
                const aprDiff = highestAprDebt.apr - currentRate;
                const annualBenefit = (Math.min(surplus * 12, highestAprDebt.balance) * aprDiff) / 100;
                recommendation = {
                    type: 'debt',
                    title: 'Pay off high-interest debt',
                    action: `Put ${formatCurrency(surplus)} towards ${highestAprDebt.name}`,
                    reasoning: `Your ${highestAprDebt.name} charges ${formatPercent(highestAprDebt.apr)} APR, but savings only earn ${formatPercent(currentRate)}. Paying debt saves you ${formatPercent(aprDiff)} (${formatCurrency(annualBenefit)}/year).`,
                    allocation: { debt: surplus, savings: 0 },
                    benefit: annualBenefit
                };
            } else {
                // Priority: Optimise savings
                recommendation = {
                    type: 'savings',
                    title: 'Maximise your savings',
                    action: `Move savings to a ${formatPercent(bestRate)} account`,
                    reasoning: `Your current rate (${formatPercent(currentRate)}) is below the best available (${formatPercent(bestRate)}). Switching earns you an extra ${formatCurrency(potentialExtraInterest)}/year.`,
                    allocation: { debt: 0, savings: surplus }
                };
            }
            
            // Financial health score (0-100)
            let healthScore = 50;
            if (surplus > 0) healthScore += 15;
            if (surplus > data.income * 0.2) healthScore += 10;
            if (emergencyFundMonths >= 3) healthScore += 15;
            if (totalDebt === 0) healthScore += 10;
            if (totalDebt < data.income) healthScore += 5;
            healthScore = Math.min(100, Math.max(0, healthScore));
            
            const healthStatus = healthScore >= 70 ? 'Healthy' : healthScore >= 40 ? 'Stable' : 'At Risk';
            
            return {
                income: data.income,
                totalBills,
                totalMinPayments,
                surplus,
                totalDebt,
                totalSavings,
                emergencyFundTarget,
                emergencyFundGap,
                emergencyFundMonths,
                debtInsights,
                currentSavingsRate: currentRate,
                bestSavingsRate: bestRate,
                potentialExtraInterest,
                recommendation,
                healthScore,
                healthStatus,
                savingsRates: UK_SAVINGS_RATES
            };
        };
        
        // ==================== COMPONENTS ====================
        
        // Navigation
        const Nav = ({ onBack, showBack }) => (
            <nav style={{
                position: 'fixed', top: 0, left: 0, right: 0, zIndex: 100,
                padding: '1rem 1.5rem',
                background: 'rgba(0,0,0,0.9)',
                backdropFilter: 'blur(20px)',
                borderBottom: '1px solid var(--border)',
                display: 'flex', justifyContent: 'space-between', alignItems: 'center'
            }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>
                    {showBack && (
                        <button onClick={onBack} style={{
                            background: 'none', border: 'none', color: 'var(--text-secondary)',
                            cursor: 'pointer', fontSize: '0.875rem', display: 'flex', alignItems: 'center', gap: '0.5rem'
                        }}>
                            ‚Üê Back
                        </button>
                    )}
                    <a href="/" style={{ fontSize: '1.125rem', fontWeight: 600, color: 'var(--text)', textDecoration: 'none' }}>
                        BOCY
                    </a>
                </div>
                <span style={{ 
                    fontFamily: 'var(--font-mono)', fontSize: '0.75rem', 
                    color: 'var(--accent)', background: 'var(--accent-dim)',
                    padding: '0.25rem 0.75rem', borderRadius: '100px'
                }}>
                    insights
                </span>
            </nav>
        );
        
        // Input Method Selection
        const InputMethodScreen = ({ onSelect }) => (
            <div style={{
                minHeight: '100vh', display: 'flex', flexDirection: 'column',
                justifyContent: 'center', alignItems: 'center',
                padding: '6rem 1.5rem 3rem', position: 'relative', zIndex: 1
            }}>
                <div style={{ maxWidth: '500px', width: '100%', textAlign: 'center' }} className="fade-in">
                    <div style={{
                        width: '64px', height: '64px', margin: '0 auto 2rem',
                        background: 'linear-gradient(135deg, var(--accent), var(--blue))',
                        borderRadius: '16px', display: 'flex', alignItems: 'center', justifyContent: 'center',
                        fontSize: '1.5rem', animation: 'float 3s ease-in-out infinite'
                    }}>
                        ‚ú¶
                    </div>
                    
                    <h1 style={{ fontSize: '1.75rem', fontWeight: 600, marginBottom: '0.75rem', letterSpacing: '-0.02em' }}>
                        Let's optimise your money
                    </h1>
                    <p style={{ color: 'var(--text-secondary)', marginBottom: '3rem', lineHeight: 1.6 }}>
                        Choose how you'd like to share your financial data. Everything stays on your device.
                    </p>
                    
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>
                        <button onClick={() => onSelect('demo')} style={{
                            padding: '1.25rem 1.5rem',
                            background: 'var(--bg-card)', border: '1px solid var(--border)',
                            borderRadius: '12px', cursor: 'pointer',
                            display: 'flex', alignItems: 'center', gap: '1rem',
                            transition: 'all 0.2s ease', textAlign: 'left'
                        }} onMouseOver={e => { e.currentTarget.style.borderColor = 'var(--accent)'; e.currentTarget.style.background = 'var(--bg-elevated)'; }}
                           onMouseOut={e => { e.currentTarget.style.borderColor = 'var(--border)'; e.currentTarget.style.background = 'var(--bg-card)'; }}>
                            <span style={{
                                width: '48px', height: '48px', borderRadius: '12px',
                                background: 'linear-gradient(135deg, var(--accent), var(--teal))',
                                display: 'flex', alignItems: 'center', justifyContent: 'center',
                                fontSize: '1.25rem', flexShrink: 0
                            }}>üéÆ</span>
                            <div>
                                <div style={{ color: 'var(--text)', fontWeight: 500, marginBottom: '0.25rem' }}>Try demo mode</div>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.875rem' }}>See BOCY in action with sample UK data</div>
                            </div>
                        </button>
                        
                        <button onClick={() => onSelect('manual')} style={{
                            padding: '1.25rem 1.5rem',
                            background: 'var(--bg-card)', border: '1px solid var(--border)',
                            borderRadius: '12px', cursor: 'pointer',
                            display: 'flex', alignItems: 'center', gap: '1rem',
                            transition: 'all 0.2s ease', textAlign: 'left'
                        }} onMouseOver={e => { e.currentTarget.style.borderColor = 'var(--accent)'; e.currentTarget.style.background = 'var(--bg-elevated)'; }}
                           onMouseOut={e => { e.currentTarget.style.borderColor = 'var(--border)'; e.currentTarget.style.background = 'var(--bg-card)'; }}>
                            <span style={{
                                width: '48px', height: '48px', borderRadius: '12px',
                                background: 'linear-gradient(135deg, var(--blue), var(--purple))',
                                display: 'flex', alignItems: 'center', justifyContent: 'center',
                                fontSize: '1.25rem', flexShrink: 0
                            }}>‚úèÔ∏è</span>
                            <div>
                                <div style={{ color: 'var(--text)', fontWeight: 500, marginBottom: '0.25rem' }}>Enter manually</div>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.875rem' }}>Quick form ‚Äî takes about 2 minutes</div>
                            </div>
                        </button>
                        
                        <button onClick={() => onSelect('upload')} style={{
                            padding: '1.25rem 1.5rem',
                            background: 'var(--bg-card)', border: '1px solid var(--border)',
                            borderRadius: '12px', cursor: 'pointer',
                            display: 'flex', alignItems: 'center', gap: '1rem',
                            transition: 'all 0.2s ease', textAlign: 'left'
                        }} onMouseOver={e => { e.currentTarget.style.borderColor = 'var(--accent)'; e.currentTarget.style.background = 'var(--bg-elevated)'; }}
                           onMouseOut={e => { e.currentTarget.style.borderColor = 'var(--border)'; e.currentTarget.style.background = 'var(--bg-card)'; }}>
                            <span style={{
                                width: '48px', height: '48px', borderRadius: '12px',
                                background: 'linear-gradient(135deg, var(--purple), var(--coral))',
                                display: 'flex', alignItems: 'center', justifyContent: 'center',
                                fontSize: '1.25rem', flexShrink: 0
                            }}>üìÑ</span>
                            <div>
                                <div style={{ color: 'var(--text)', fontWeight: 500, marginBottom: '0.25rem' }}>Upload statement</div>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.875rem' }}>CSV from your bank ‚Äî we'll parse it</div>
                            </div>
                        </button>
                    </div>
                    
                    <p style={{ 
                        marginTop: '2rem', fontSize: '0.75rem', color: 'var(--text-muted)',
                        fontFamily: 'var(--font-mono)'
                    }}>
                        [=] Your data never leaves your browser
                    </p>
                </div>
            </div>
        );
        
        // Manual Input Form
        const ManualInputScreen = ({ onSubmit, initialData }) => {
            const [step, setStep] = useState(1);
            const [data, setData] = useState(initialData || {
                income: '',
                bills: { rent: '', utilities: '', phone: '', subscriptions: '', insurance: '', transport: '', groceries: '', other: '' },
                debts: [{ name: 'Credit Card', balance: '', apr: '', minPayment: '' }],
                savings: { currentAccount: '', savingsAccount: '', savingsRate: '' }
            });
            
            const updateBill = (key, value) => {
                setData(prev => ({ ...prev, bills: { ...prev.bills, [key]: value } }));
            };
            
            const updateDebt = (index, field, value) => {
                setData(prev => {
                    const newDebts = [...prev.debts];
                    newDebts[index] = { ...newDebts[index], [field]: value };
                    return { ...prev, debts: newDebts };
                });
            };
            
            const addDebt = () => {
                setData(prev => ({
                    ...prev,
                    debts: [...prev.debts, { name: '', balance: '', apr: '', minPayment: '' }]
                }));
            };
            
            const updateSavings = (field, value) => {
                setData(prev => ({ ...prev, savings: { ...prev.savings, [field]: value } }));
            };
            
            const handleSubmit = () => {
                // Convert strings to numbers
                const cleanData = {
                    income: parseFloat(data.income) || 0,
                    bills: Object.fromEntries(
                        Object.entries(data.bills).map(([k, v]) => [k, parseFloat(v) || 0])
                    ),
                    debts: data.debts.map(d => ({
                        name: d.name || 'Debt',
                        balance: parseFloat(d.balance) || 0,
                        apr: parseFloat(d.apr) || 0,
                        minPayment: parseFloat(d.minPayment) || 0
                    })).filter(d => d.balance > 0),
                    savings: {
                        currentAccount: parseFloat(data.savings.currentAccount) || 0,
                        savingsAccount: parseFloat(data.savings.savingsAccount) || 0,
                        savingsRate: parseFloat(data.savings.savingsRate) || 0
                    }
                };
                onSubmit(cleanData);
            };
            
            const inputStyle = {
                width: '100%', padding: '0.875rem 1rem',
                background: 'var(--bg)', border: '1px solid var(--border)',
                borderRadius: '8px', color: 'var(--text)',
                fontSize: '1rem', fontFamily: 'inherit',
                outline: 'none', transition: 'border-color 0.2s'
            };
            
            const labelStyle = {
                display: 'block', marginBottom: '0.5rem',
                fontSize: '0.875rem', color: 'var(--text-secondary)'
            };
            
            return (
                <div style={{
                    minHeight: '100vh', padding: '6rem 1.5rem 3rem',
                    position: 'relative', zIndex: 1
                }}>
                    <div style={{ maxWidth: '500px', margin: '0 auto' }} className="fade-in">
                        {/* Progress */}
                        <div style={{ marginBottom: '2rem' }}>
                            <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem' }}>
                                <span style={{ fontSize: '0.875rem', color: 'var(--text-muted)' }}>Step {step} of 4</span>
                                <span style={{ fontSize: '0.875rem', color: 'var(--text-muted)' }}>{step * 25}%</span>
                            </div>
                            <div style={{ height: '4px', background: 'var(--border)', borderRadius: '2px', overflow: 'hidden' }}>
                                <div style={{ 
                                    height: '100%', width: `${step * 25}%`, 
                                    background: 'var(--accent)', transition: 'width 0.3s ease' 
                                }} />
                            </div>
                        </div>
                        
                        {/* Step 1: Income */}
                        {step === 1 && (
                            <div className="slide-in">
                                <h2 style={{ fontSize: '1.5rem', fontWeight: 600, marginBottom: '0.5rem' }}>
                                    What's your monthly income?
                                </h2>
                                <p style={{ color: 'var(--text-secondary)', marginBottom: '2rem' }}>
                                    After tax ‚Äî what hits your bank account each month.
                                </p>
                                <div style={{ marginBottom: '1.5rem' }}>
                                    <label style={labelStyle}>Monthly take-home pay</label>
                                    <div style={{ position: 'relative' }}>
                                        <span style={{ 
                                            position: 'absolute', left: '1rem', top: '50%', transform: 'translateY(-50%)',
                                            color: 'var(--text-muted)', fontSize: '1rem'
                                        }}>¬£</span>
                                        <input
                                            type="number"
                                            value={data.income}
                                            onChange={e => setData(prev => ({ ...prev, income: e.target.value }))}
                                            placeholder="3,200"
                                            style={{ ...inputStyle, paddingLeft: '2rem' }}
                                            onFocus={e => e.target.style.borderColor = 'var(--accent)'}
                                            onBlur={e => e.target.style.borderColor = 'var(--border)'}
                                        />
                                    </div>
                                </div>
                                <button
                                    onClick={() => setStep(2)}
                                    disabled={!data.income}
                                    style={{
                                        width: '100%', padding: '1rem',
                                        background: data.income ? 'var(--text)' : 'var(--bg-muted)',
                                        color: data.income ? 'var(--bg)' : 'var(--text-muted)',
                                        border: 'none', borderRadius: '10px',
                                        fontSize: '1rem', fontWeight: 500, cursor: data.income ? 'pointer' : 'not-allowed'
                                    }}
                                >
                                    Continue
                                </button>
                            </div>
                        )}
                        
                        {/* Step 2: Bills */}
                        {step === 2 && (
                            <div className="slide-in">
                                <h2 style={{ fontSize: '1.5rem', fontWeight: 600, marginBottom: '0.5rem' }}>
                                    What are your monthly bills?
                                </h2>
                                <p style={{ color: 'var(--text-secondary)', marginBottom: '2rem' }}>
                                    Enter what you typically spend. Leave blank if not applicable.
                                </p>
                                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem', marginBottom: '1.5rem' }}>
                                    {[
                                        ['rent', 'Rent/Mortgage'],
                                        ['utilities', 'Utilities'],
                                        ['phone', 'Phone'],
                                        ['subscriptions', 'Subscriptions'],
                                        ['insurance', 'Insurance'],
                                        ['transport', 'Transport'],
                                        ['groceries', 'Groceries'],
                                        ['other', 'Other']
                                    ].map(([key, label]) => (
                                        <div key={key}>
                                            <label style={{ ...labelStyle, fontSize: '0.75rem' }}>{label}</label>
                                            <div style={{ position: 'relative' }}>
                                                <span style={{ 
                                                    position: 'absolute', left: '0.75rem', top: '50%', transform: 'translateY(-50%)',
                                                    color: 'var(--text-muted)', fontSize: '0.875rem'
                                                }}>¬£</span>
                                                <input
                                                    type="number"
                                                    value={data.bills[key]}
                                                    onChange={e => updateBill(key, e.target.value)}
                                                    placeholder="0"
                                                    style={{ ...inputStyle, paddingLeft: '1.75rem', padding: '0.75rem 0.75rem 0.75rem 1.75rem', fontSize: '0.875rem' }}
                                                    onFocus={e => e.target.style.borderColor = 'var(--accent)'}
                                                    onBlur={e => e.target.style.borderColor = 'var(--border)'}
                                                />
                                            </div>
                                        </div>
                                    ))}
                                </div>
                                <div style={{ display: 'flex', gap: '0.75rem' }}>
                                    <button
                                        onClick={() => setStep(1)}
                                        style={{
                                            flex: 1, padding: '1rem',
                                            background: 'transparent', color: 'var(--text-secondary)',
                                            border: '1px solid var(--border)', borderRadius: '10px',
                                            fontSize: '1rem', cursor: 'pointer'
                                        }}
                                    >
                                        Back
                                    </button>
                                    <button
                                        onClick={() => setStep(3)}
                                        style={{
                                            flex: 2, padding: '1rem',
                                            background: 'var(--text)', color: 'var(--bg)',
                                            border: 'none', borderRadius: '10px',
                                            fontSize: '1rem', fontWeight: 500, cursor: 'pointer'
                                        }}
                                    >
                                        Continue
                                    </button>
                                </div>
                            </div>
                        )}
                        
                        {/* Step 3: Debts */}
                        {step === 3 && (
                            <div className="slide-in">
                                <h2 style={{ fontSize: '1.5rem', fontWeight: 600, marginBottom: '0.5rem' }}>
                                    Any debts?
                                </h2>
                                <p style={{ color: 'var(--text-secondary)', marginBottom: '2rem' }}>
                                    Credit cards, overdrafts, loans. Skip if none.
                                </p>
                                {data.debts.map((debt, index) => (
                                    <div key={index} style={{ 
                                        padding: '1rem', marginBottom: '1rem',
                                        background: 'var(--bg-card)', border: '1px solid var(--border)',
                                        borderRadius: '10px'
                                    }}>
                                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.75rem' }}>
                                            <div style={{ gridColumn: 'span 2' }}>
                                                <label style={{ ...labelStyle, fontSize: '0.75rem' }}>Name</label>
                                                <input
                                                    type="text"
                                                    value={debt.name}
                                                    onChange={e => updateDebt(index, 'name', e.target.value)}
                                                    placeholder="Credit Card"
                                                    style={{ ...inputStyle, fontSize: '0.875rem', padding: '0.75rem' }}
                                                    onFocus={e => e.target.style.borderColor = 'var(--accent)'}
                                                    onBlur={e => e.target.style.borderColor = 'var(--border)'}
                                                />
                                            </div>
                                            <div>
                                                <label style={{ ...labelStyle, fontSize: '0.75rem' }}>Balance (¬£)</label>
                                                <input
                                                    type="number"
                                                    value={debt.balance}
                                                    onChange={e => updateDebt(index, 'balance', e.target.value)}
                                                    placeholder="2,400"
                                                    style={{ ...inputStyle, fontSize: '0.875rem', padding: '0.75rem' }}
                                                    onFocus={e => e.target.style.borderColor = 'var(--accent)'}
                                                    onBlur={e => e.target.style.borderColor = 'var(--border)'}
                                                />
                                            </div>
                                            <div>
                                                <label style={{ ...labelStyle, fontSize: '0.75rem' }}>APR (%)</label>
                                                <input
                                                    type="number"
                                                    step="0.1"
                                                    value={debt.apr}
                                                    onChange={e => updateDebt(index, 'apr', e.target.value)}
                                                    placeholder="18.9"
                                                    style={{ ...inputStyle, fontSize: '0.875rem', padding: '0.75rem' }}
                                                    onFocus={e => e.target.style.borderColor = 'var(--accent)'}
                                                    onBlur={e => e.target.style.borderColor = 'var(--border)'}
                                                />
                                            </div>
                                            <div style={{ gridColumn: 'span 2' }}>
                                                <label style={{ ...labelStyle, fontSize: '0.75rem' }}>Min payment (¬£/month)</label>
                                                <input
                                                    type="number"
                                                    value={debt.minPayment}
                                                    onChange={e => updateDebt(index, 'minPayment', e.target.value)}
                                                    placeholder="65"
                                                    style={{ ...inputStyle, fontSize: '0.875rem', padding: '0.75rem' }}
                                                    onFocus={e => e.target.style.borderColor = 'var(--accent)'}
                                                    onBlur={e => e.target.style.borderColor = 'var(--border)'}
                                                />
                                            </div>
                                        </div>
                                    </div>
                                ))}
                                <button
                                    onClick={addDebt}
                                    style={{
                                        width: '100%', padding: '0.75rem', marginBottom: '1.5rem',
                                        background: 'transparent', color: 'var(--text-muted)',
                                        border: '1px dashed var(--border)', borderRadius: '10px',
                                        fontSize: '0.875rem', cursor: 'pointer'
                                    }}
                                >
                                    + Add another debt
                                </button>
                                <div style={{ display: 'flex', gap: '0.75rem' }}>
                                    <button
                                        onClick={() => setStep(2)}
                                        style={{
                                            flex: 1, padding: '1rem',
                                            background: 'transparent', color: 'var(--text-secondary)',
                                            border: '1px solid var(--border)', borderRadius: '10px',
                                            fontSize: '1rem', cursor: 'pointer'
                                        }}
                                    >
                                        Back
                                    </button>
                                    <button
                                        onClick={() => setStep(4)}
                                        style={{
                                            flex: 2, padding: '1rem',
                                            background: 'var(--text)', color: 'var(--bg)',
                                            border: 'none', borderRadius: '10px',
                                            fontSize: '1rem', fontWeight: 500, cursor: 'pointer'
                                        }}
                                    >
                                        Continue
                                    </button>
                                </div>
                            </div>
                        )}
                        
                        {/* Step 4: Savings */}
                        {step === 4 && (
                            <div className="slide-in">
                                <h2 style={{ fontSize: '1.5rem', fontWeight: 600, marginBottom: '0.5rem' }}>
                                    What about savings?
                                </h2>
                                <p style={{ color: 'var(--text-secondary)', marginBottom: '2rem' }}>
                                    Current balances and your savings account interest rate.
                                </p>
                                <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem', marginBottom: '1.5rem' }}>
                                    <div>
                                        <label style={labelStyle}>Current account balance</label>
                                        <div style={{ position: 'relative' }}>
                                            <span style={{ 
                                                position: 'absolute', left: '1rem', top: '50%', transform: 'translateY(-50%)',
                                                color: 'var(--text-muted)'
                                            }}>¬£</span>
                                            <input
                                                type="number"
                                                value={data.savings.currentAccount}
                                                onChange={e => updateSavings('currentAccount', e.target.value)}
                                                placeholder="450"
                                                style={{ ...inputStyle, paddingLeft: '2rem' }}
                                                onFocus={e => e.target.style.borderColor = 'var(--accent)'}
                                                onBlur={e => e.target.style.borderColor = 'var(--border)'}
                                            />
                                        </div>
                                    </div>
                                    <div>
                                        <label style={labelStyle}>Savings account balance</label>
                                        <div style={{ position: 'relative' }}>
                                            <span style={{ 
                                                position: 'absolute', left: '1rem', top: '50%', transform: 'translateY(-50%)',
                                                color: 'var(--text-muted)'
                                            }}>¬£</span>
                                            <input
                                                type="number"
                                                value={data.savings.savingsAccount}
                                                onChange={e => updateSavings('savingsAccount', e.target.value)}
                                                placeholder="1,200"
                                                style={{ ...inputStyle, paddingLeft: '2rem' }}
                                                onFocus={e => e.target.style.borderColor = 'var(--accent)'}
                                                onBlur={e => e.target.style.borderColor = 'var(--border)'}
                                            />
                                        </div>
                                    </div>
                                    <div>
                                        <label style={labelStyle}>Current savings interest rate (% AER)</label>
                                        <input
                                            type="number"
                                            step="0.1"
                                            value={data.savings.savingsRate}
                                            onChange={e => updateSavings('savingsRate', e.target.value)}
                                            placeholder="4.5"
                                            style={inputStyle}
                                            onFocus={e => e.target.style.borderColor = 'var(--accent)'}
                                            onBlur={e => e.target.style.borderColor = 'var(--border)'}
                                        />
                                    </div>
                                </div>
                                <div style={{ display: 'flex', gap: '0.75rem' }}>
                                    <button
                                        onClick={() => setStep(3)}
                                        style={{
                                            flex: 1, padding: '1rem',
                                            background: 'transparent', color: 'var(--text-secondary)',
                                            border: '1px solid var(--border)', borderRadius: '10px',
                                            fontSize: '1rem', cursor: 'pointer'
                                        }}
                                    >
                                        Back
                                    </button>
                                    <button
                                        onClick={handleSubmit}
                                        style={{
                                            flex: 2, padding: '1rem',
                                            background: 'var(--accent)', color: 'var(--bg)',
                                            border: 'none', borderRadius: '10px',
                                            fontSize: '1rem', fontWeight: 600, cursor: 'pointer'
                                        }}
                                    >
                                        See my insights ‚Üí
                                    </button>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };
        
        // CSV Upload Screen
        const UploadScreen = ({ onSubmit, onManualFallback }) => {
            const [isDragging, setIsDragging] = useState(false);
            const [error, setError] = useState('');
            const [parsing, setParsing] = useState(false);
            
            const handleFile = (file) => {
                if (!file.name.endsWith('.csv')) {
                    setError('Please upload a CSV file');
                    return;
                }
                
                setParsing(true);
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        // Simple CSV parsing - in production you'd want more robust parsing
                        const text = e.target.result;
                        const lines = text.split('\n').filter(l => l.trim());
                        
                        // Try to detect income and expenses from common bank statement formats
                        let totalIn = 0;
                        let totalOut = 0;
                        
                        lines.forEach(line => {
                            const parts = line.split(',');
                            parts.forEach(part => {
                                const num = parseFloat(part.replace(/[^0-9.-]/g, ''));
                                if (!isNaN(num)) {
                                    if (num > 0) totalIn += num;
                                    else totalOut += Math.abs(num);
                                }
                            });
                        });
                        
                        // Create approximate data structure
                        const parsedData = {
                            income: Math.round(totalIn / Math.max(1, lines.length / 30) * 0.7), // Estimate monthly
                            bills: {
                                rent: 0, utilities: 0, phone: 0, subscriptions: 0,
                                insurance: 0, transport: 0, groceries: 0,
                                other: Math.round(totalOut / Math.max(1, lines.length / 30) * 0.6)
                            },
                            debts: [],
                            savings: { currentAccount: 0, savingsAccount: 0, savingsRate: 4.0 }
                        };
                        
                        setParsing(false);
                        onManualFallback(parsedData);
                    } catch (err) {
                        setParsing(false);
                        setError('Could not parse file. Try manual entry instead.');
                    }
                };
                reader.readAsText(file);
            };
            
            return (
                <div style={{
                    minHeight: '100vh', display: 'flex', flexDirection: 'column',
                    justifyContent: 'center', alignItems: 'center',
                    padding: '6rem 1.5rem 3rem', position: 'relative', zIndex: 1
                }}>
                    <div style={{ maxWidth: '500px', width: '100%', textAlign: 'center' }} className="fade-in">
                        <h1 style={{ fontSize: '1.5rem', fontWeight: 600, marginBottom: '0.5rem' }}>
                            Upload your bank statement
                        </h1>
                        <p style={{ color: 'var(--text-secondary)', marginBottom: '2rem' }}>
                            Download a CSV from your bank's app or website.
                        </p>
                        
                        <div
                            onDragOver={(e) => { e.preventDefault(); setIsDragging(true); }}
                            onDragLeave={() => setIsDragging(false)}
                            onDrop={(e) => {
                                e.preventDefault();
                                setIsDragging(false);
                                handleFile(e.dataTransfer.files[0]);
                            }}
                            style={{
                                padding: '3rem 2rem',
                                border: `2px dashed ${isDragging ? 'var(--accent)' : 'var(--border)'}`,
                                borderRadius: '12px',
                                background: isDragging ? 'var(--accent-dim)' : 'var(--bg-card)',
                                transition: 'all 0.2s ease',
                                marginBottom: '1rem'
                            }}
                        >
                            {parsing ? (
                                <div>
                                    <div style={{ 
                                        width: '48px', height: '48px', margin: '0 auto 1rem',
                                        border: '3px solid var(--border)', borderTopColor: 'var(--accent)',
                                        borderRadius: '50%', animation: 'spin 1s linear infinite'
                                    }} />
                                    <style>{`@keyframes spin { to { transform: rotate(360deg); } }`}</style>
                                    <p style={{ color: 'var(--text-secondary)' }}>Analysing your statement...</p>
                                </div>
                            ) : (
                                <>
                                    <div style={{ fontSize: '2rem', marginBottom: '1rem' }}>üìÑ</div>
                                    <p style={{ color: 'var(--text)', marginBottom: '0.5rem' }}>
                                        Drag & drop your CSV here
                                    </p>
                                    <p style={{ color: 'var(--text-muted)', fontSize: '0.875rem', marginBottom: '1rem' }}>
                                        or
                                    </p>
                                    <label style={{
                                        display: 'inline-block', padding: '0.75rem 1.5rem',
                                        background: 'var(--text)', color: 'var(--bg)',
                                        borderRadius: '8px', cursor: 'pointer',
                                        fontSize: '0.875rem', fontWeight: 500
                                    }}>
                                        Browse files
                                        <input
                                            type="file"
                                            accept=".csv"
                                            onChange={(e) => handleFile(e.target.files[0])}
                                            style={{ display: 'none' }}
                                        />
                                    </label>
                                </>
                            )}
                        </div>
                        
                        {error && (
                            <p style={{ color: 'var(--coral)', fontSize: '0.875rem', marginBottom: '1rem' }}>{error}</p>
                        )}
                        
                        <button
                            onClick={() => onManualFallback(null)}
                            style={{
                                background: 'none', border: 'none',
                                color: 'var(--text-muted)', fontSize: '0.875rem',
                                cursor: 'pointer', textDecoration: 'underline'
                            }}
                        >
                            Enter manually instead
                        </button>
                    </div>
                </div>
            );
        };
        
        // Dashboard / Results Screen
        const DashboardScreen = ({ data, insights, onReset }) => {
            const [activeTab, setActiveTab] = useState('overview');
            
            const tabStyle = (isActive) => ({
                padding: '0.75rem 1rem',
                background: isActive ? 'var(--bg-elevated)' : 'transparent',
                border: isActive ? '1px solid var(--border)' : '1px solid transparent',
                borderRadius: '8px',
                color: isActive ? 'var(--text)' : 'var(--text-muted)',
                fontSize: '0.875rem', fontWeight: 500,
                cursor: 'pointer', transition: 'all 0.2s ease'
            });
            
            return (
                <div style={{ minHeight: '100vh', padding: '5rem 1rem 3rem', position: 'relative', zIndex: 1 }}>
                    <div style={{ maxWidth: '800px', margin: '0 auto' }}>
                        {/* Health Status Card */}
                        <div className="fade-in" style={{
                            background: 'linear-gradient(135deg, var(--bg-elevated), var(--bg-card))',
                            border: '1px solid var(--border)',
                            borderRadius: '16px', padding: '2rem',
                            marginBottom: '1.5rem', textAlign: 'center'
                        }}>
                            <div style={{
                                width: '80px', height: '80px', margin: '0 auto 1rem',
                                background: insights.healthScore >= 70 ? 'var(--accent)' : insights.healthScore >= 40 ? 'var(--yellow)' : 'var(--coral)',
                                borderRadius: '50%', display: 'flex', alignItems: 'center', justifyContent: 'center',
                                fontSize: '1.5rem', fontWeight: 700, color: 'var(--bg)',
                                animation: 'glow 2s ease-in-out infinite'
                            }}>
                                {insights.healthScore}
                            </div>
                            <p style={{ color: 'var(--text-muted)', fontSize: '0.75rem', marginBottom: '0.25rem', fontFamily: 'var(--font-mono)' }}>
                                financial health
                            </p>
                            <h2 style={{ fontSize: '1.5rem', fontWeight: 600, marginBottom: '0.5rem' }}>
                                Your money is {insights.healthStatus}
                            </h2>
                            <p style={{ color: 'var(--text-secondary)', fontSize: '0.875rem' }}>
                                Monthly surplus: <span style={{ color: insights.surplus >= 0 ? 'var(--accent)' : 'var(--coral)', fontWeight: 600 }}>
                                    {formatCurrency(insights.surplus)}
                                </span>
                            </p>
                        </div>
                        
                        {/* Quick Stats */}
                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '0.75rem', marginBottom: '1.5rem' }}>
                            {[
                                { label: 'Income', value: formatCurrency(insights.income), color: 'var(--blue)' },
                                { label: 'Bills', value: formatCurrency(insights.totalBills), color: 'var(--text-secondary)' },
                                { label: 'Savings', value: formatCurrency(insights.totalSavings), color: 'var(--teal)' }
                            ].map((stat, i) => (
                                <div key={i} className="fade-in" style={{
                                    background: 'var(--bg-card)', border: '1px solid var(--border)',
                                    borderRadius: '12px', padding: '1rem', textAlign: 'center',
                                    animationDelay: `${i * 0.1}s`
                                }}>
                                    <p style={{ fontSize: '0.625rem', color: 'var(--text-muted)', marginBottom: '0.25rem', fontFamily: 'var(--font-mono)', textTransform: 'uppercase' }}>
                                        {stat.label}
                                    </p>
                                    <p style={{ fontSize: '1.125rem', fontWeight: 600, color: stat.color }}>
                                        {stat.value}
                                    </p>
                                </div>
                            ))}
                        </div>
                        
                        {/* Tabs */}
                        <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1.5rem', overflowX: 'auto' }}>
                            <button style={tabStyle(activeTab === 'overview')} onClick={() => setActiveTab('overview')}>
                                Recommendation
                            </button>
                            <button style={tabStyle(activeTab === 'debt')} onClick={() => setActiveTab('debt')}>
                                Debt Analysis
                            </button>
                            <button style={tabStyle(activeTab === 'savings')} onClick={() => setActiveTab('savings')}>
                                Savings Rates
                            </button>
                            <button style={tabStyle(activeTab === 'emergency')} onClick={() => setActiveTab('emergency')}>
                                Emergency Fund
                            </button>
                        </div>
                        
                        {/* Tab Content */}
                        <div className="scale-in">
                            {/* Recommendation Tab */}
                            {activeTab === 'overview' && (
                                <div style={{
                                    background: 'var(--bg-card)', border: '1px solid var(--border)',
                                    borderRadius: '16px', padding: '1.5rem'
                                }}>
                                    <div style={{
                                        display: 'flex', alignItems: 'center', gap: '0.75rem',
                                        marginBottom: '1rem'
                                    }}>
                                        <div style={{
                                            width: '40px', height: '40px', borderRadius: '10px',
                                            background: insights.recommendation.type === 'debt' ? 'var(--coral)' :
                                                       insights.recommendation.type === 'emergency' ? 'var(--yellow)' :
                                                       insights.recommendation.type === 'warning' ? 'var(--coral)' : 'var(--accent)',
                                            display: 'flex', alignItems: 'center', justifyContent: 'center',
                                            fontSize: '1.25rem'
                                        }}>
                                            {insights.recommendation.type === 'debt' ? 'üí≥' :
                                             insights.recommendation.type === 'emergency' ? 'üõ°Ô∏è' :
                                             insights.recommendation.type === 'warning' ? '‚ö†Ô∏è' : 'üìà'}
                                        </div>
                                        <div>
                                            <p style={{ fontSize: '0.625rem', color: 'var(--text-muted)', fontFamily: 'var(--font-mono)', textTransform: 'uppercase' }}>
                                                BOCY recommends
                                            </p>
                                            <h3 style={{ fontSize: '1.125rem', fontWeight: 600 }}>
                                                {insights.recommendation.title}
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <div style={{
                                        background: 'var(--bg)', border: '1px solid var(--border)',
                                        borderRadius: '10px', padding: '1rem', marginBottom: '1rem'
                                    }}>
                                        <p style={{ fontFamily: 'var(--font-mono)', fontSize: '0.875rem', color: 'var(--accent)', marginBottom: '0.5rem' }}>
                                            ‚Üí {insights.recommendation.action}
                                        </p>
                                        {insights.recommendation.benefit && (
                                            <p style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>
                                                Estimated benefit: <span style={{ color: 'var(--accent)' }}>{formatCurrency(insights.recommendation.benefit)}/year</span>
                                            </p>
                                        )}
                                    </div>
                                    
                                    <div style={{
                                        background: 'var(--bg-subtle)', borderRadius: '8px',
                                        padding: '1rem', marginBottom: '1.5rem'
                                    }}>
                                        <p style={{ fontSize: '0.75rem', color: 'var(--text-muted)', marginBottom: '0.5rem', fontFamily: 'var(--font-mono)' }}>
                                            // Why this recommendation?
                                        </p>
                                        <p style={{ fontSize: '0.875rem', color: 'var(--text-secondary)', lineHeight: 1.6 }}>
                                            {insights.recommendation.reasoning}
                                        </p>
                                    </div>
                                    
                                    <div style={{ display: 'flex', gap: '0.75rem' }}>
                                        <button style={{
                                            flex: 1, padding: '0.875rem',
                                            background: 'var(--text)', color: 'var(--bg)',
                                            border: 'none', borderRadius: '10px',
                                            fontSize: '0.875rem', fontWeight: 600, cursor: 'pointer'
                                        }}>
                                            ‚úì Got it
                                        </button>
                                        <button style={{
                                            padding: '0.875rem 1.25rem',
                                            background: 'transparent', color: 'var(--text-secondary)',
                                            border: '1px solid var(--border)', borderRadius: '10px',
                                            fontSize: '0.875rem', cursor: 'pointer'
                                        }}>
                                            Learn more
                                        </button>
                                    </div>
                                </div>
                            )}
                            
                            {/* Debt Tab */}
                            {activeTab === 'debt' && (
                                <div style={{
                                    background: 'var(--bg-card)', border: '1px solid var(--border)',
                                    borderRadius: '16px', padding: '1.5rem'
                                }}>
                                    <h3 style={{ fontSize: '1rem', fontWeight: 600, marginBottom: '1rem' }}>
                                        Debt Optimisation
                                    </h3>
                                    
                                    {insights.debtInsights.length === 0 ? (
                                        <div style={{ textAlign: 'center', padding: '2rem' }}>
                                            <div style={{ fontSize: '2rem', marginBottom: '0.5rem' }}>üéâ</div>
                                            <p style={{ color: 'var(--text-secondary)' }}>No debts to optimise!</p>
                                        </div>
                                    ) : (
                                        <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>
                                            {insights.debtInsights.map((debt, i) => (
                                                <div key={i} style={{
                                                    background: 'var(--bg)', border: '1px solid var(--border)',
                                                    borderRadius: '10px', padding: '1rem'
                                                }}>
                                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.75rem' }}>
                                                        <span style={{ fontWeight: 500 }}>{debt.name}</span>
                                                        <span style={{ 
                                                            fontSize: '0.75rem', padding: '0.25rem 0.5rem',
                                                            background: debt.apr > 20 ? 'rgba(255,107,107,0.1)' : 'rgba(251,191,36,0.1)',
                                                            color: debt.apr > 20 ? 'var(--coral)' : 'var(--yellow)',
                                                            borderRadius: '4px', fontFamily: 'var(--font-mono)'
                                                        }}>
                                                            {formatPercent(debt.apr)} APR
                                                        </span>
                                                    </div>
                                                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.75rem', fontFamily: 'var(--font-mono)', fontSize: '0.75rem' }}>
                                                        <div>
                                                            <span style={{ color: 'var(--text-muted)' }}>balance</span>
                                                            <p style={{ color: 'var(--text)', fontSize: '0.875rem' }}>{formatCurrency(debt.balance)}</p>
                                                        </div>
                                                        <div>
                                                            <span style={{ color: 'var(--text-muted)' }}>interest/year</span>
                                                            <p style={{ color: 'var(--coral)', fontSize: '0.875rem' }}>-{formatCurrency(debt.annualInterest)}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                            
                                            {insights.totalDebt > 0 && (
                                                <div style={{
                                                    background: 'var(--bg-subtle)', borderRadius: '8px',
                                                    padding: '1rem', marginTop: '0.5rem'
                                                }}>
                                                    <p style={{ fontSize: '0.75rem', color: 'var(--text-muted)', marginBottom: '0.25rem' }}>
                                                        Total debt interest you're paying:
                                                    </p>
                                                    <p style={{ fontSize: '1.25rem', fontWeight: 600, color: 'var(--coral)' }}>
                                                        {formatCurrency(insights.debtInsights.reduce((a, d) => a + d.annualInterest, 0))}/year
                                                    </p>
                                                </div>
                                            )}
                                        </div>
                                    )}
                                </div>
                            )}
                            
                            {/* Savings Tab */}
                            {activeTab === 'savings' && (
                                <div style={{
                                    background: 'var(--bg-card)', border: '1px solid var(--border)',
                                    borderRadius: '16px', padding: '1.5rem'
                                }}>
                                    <h3 style={{ fontSize: '1rem', fontWeight: 600, marginBottom: '1rem' }}>
                                        Savings Rate Comparison
                                    </h3>
                                    
                                    <div style={{
                                        background: 'var(--bg)', border: '1px solid var(--border)',
                                        borderRadius: '10px', padding: '1rem', marginBottom: '1rem'
                                    }}>
                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                            <div>
                                                <p style={{ fontSize: '0.75rem', color: 'var(--text-muted)', fontFamily: 'var(--font-mono)' }}>YOUR CURRENT RATE</p>
                                                <p style={{ fontSize: '1.5rem', fontWeight: 600 }}>{formatPercent(insights.currentSavingsRate)}</p>
                                            </div>
                                            <div style={{ textAlign: 'right' }}>
                                                <p style={{ fontSize: '0.75rem', color: 'var(--text-muted)', fontFamily: 'var(--font-mono)' }}>BEST AVAILABLE</p>
                                                <p style={{ fontSize: '1.5rem', fontWeight: 600, color: 'var(--accent)' }}>{formatPercent(insights.bestSavingsRate)}</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    {insights.potentialExtraInterest > 0 && (
                                        <div style={{
                                            background: 'var(--accent-dim)', border: '1px solid rgba(0,212,170,0.2)',
                                            borderRadius: '8px', padding: '0.875rem', marginBottom: '1rem'
                                        }}>
                                            <p style={{ fontSize: '0.875rem', color: 'var(--accent)' }}>
                                                üí° Switching could earn you an extra <strong>{formatCurrency(insights.potentialExtraInterest)}/year</strong>
                                            </p>
                                        </div>
                                    )}
                                    
                                    <p style={{ fontSize: '0.75rem', color: 'var(--text-muted)', marginBottom: '0.75rem', fontFamily: 'var(--font-mono)' }}>
                                        TOP UK SAVINGS ACCOUNTS
                                    </p>
                                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>
                                        {insights.savingsRates.map((rate, i) => (
                                            <div key={i} style={{
                                                display: 'flex', justifyContent: 'space-between', alignItems: 'center',
                                                padding: '0.75rem', background: 'var(--bg)', borderRadius: '8px',
                                                border: '1px solid var(--border)'
                                            }}>
                                                <div>
                                                    <p style={{ fontWeight: 500, fontSize: '0.875rem' }}>{rate.name}</p>
                                                    <p style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>{rate.type}</p>
                                                </div>
                                                <span style={{
                                                    fontSize: '1rem', fontWeight: 600,
                                                    color: rate.rate === insights.bestSavingsRate ? 'var(--accent)' : 'var(--text)'
                                                }}>
                                                    {formatPercent(rate.rate)}
                                                </span>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                            
                            {/* Emergency Fund Tab */}
                            {activeTab === 'emergency' && (
                                <div style={{
                                    background: 'var(--bg-card)', border: '1px solid var(--border)',
                                    borderRadius: '16px', padding: '1.5rem'
                                }}>
                                    <h3 style={{ fontSize: '1rem', fontWeight: 600, marginBottom: '1rem' }}>
                                        Emergency Fund Status
                                    </h3>
                                    
                                    <div style={{
                                        background: 'var(--bg)', borderRadius: '10px',
                                        padding: '1.25rem', marginBottom: '1rem', textAlign: 'center'
                                    }}>
                                        <p style={{ fontSize: '3rem', fontWeight: 700, marginBottom: '0.25rem' }}>
                                            {insights.emergencyFundMonths.toFixed(1)}
                                        </p>
                                        <p style={{ color: 'var(--text-muted)', fontSize: '0.875rem' }}>
                                            months of expenses covered
                                        </p>
                                    </div>
                                    
                                    {/* Progress bar */}
                                    <div style={{ marginBottom: '1rem' }}>
                                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem' }}>
                                            <span style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>Current</span>
                                            <span style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>Target (3 months)</span>
                                        </div>
                                        <div style={{ height: '8px', background: 'var(--bg-subtle)', borderRadius: '4px', overflow: 'hidden' }}>
                                            <div style={{
                                                height: '100%',
                                                width: `${Math.min(100, (insights.totalSavings / insights.emergencyFundTarget) * 100)}%`,
                                                background: insights.emergencyFundMonths >= 3 ? 'var(--accent)' : 'var(--yellow)',
                                                transition: 'width 0.5s ease'
                                            }} />
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between', marginTop: '0.5rem' }}>
                                            <span style={{ fontSize: '0.875rem', fontWeight: 500 }}>{formatCurrency(insights.totalSavings)}</span>
                                            <span style={{ fontSize: '0.875rem', color: 'var(--text-muted)' }}>{formatCurrency(insights.emergencyFundTarget)}</span>
                                        </div>
                                    </div>
                                    
                                    {insights.emergencyFundGap > 0 ? (
                                        <div style={{
                                            background: 'rgba(251,191,36,0.1)', border: '1px solid rgba(251,191,36,0.2)',
                                            borderRadius: '8px', padding: '1rem'
                                        }}>
                                            <p style={{ fontSize: '0.875rem', color: 'var(--yellow)' }}>
                                                üéØ You need <strong>{formatCurrency(insights.emergencyFundGap)}</strong> more to reach 3 months of expenses.
                                                {insights.surplus > 0 && (
                                                    <span> At your current surplus, that's about <strong>{Math.ceil(insights.emergencyFundGap / insights.surplus)} months</strong> away.</span>
                                                )}
                                            </p>
                                        </div>
                                    ) : (
                                        <div style={{
                                            background: 'var(--accent-dim)', border: '1px solid rgba(0,212,170,0.2)',
                                            borderRadius: '8px', padding: '1rem'
                                        }}>
                                            <p style={{ fontSize: '0.875rem', color: 'var(--accent)' }}>
                                                ‚úì Great job! You have a solid emergency fund covering {insights.emergencyFundMonths.toFixed(1)} months.
                                            </p>
                                        </div>
                                    )}
                                </div>
                            )}
                        </div>
                        
                        {/* CTA */}
                        <div style={{
                            background: 'linear-gradient(135deg, var(--bg-elevated), var(--bg-subtle))',
                            border: '1px solid var(--border)',
                            borderRadius: '16px', padding: '1.5rem',
                            marginTop: '1.5rem', textAlign: 'center'
                        }}>
                            <p style={{ fontSize: '0.875rem', color: 'var(--text-secondary)', marginBottom: '1rem' }}>
                                Want automatic weekly optimisation?
                            </p>
                            <a href="/#waitlist" style={{
                                display: 'inline-block', padding: '0.875rem 1.5rem',
                                background: 'var(--accent)', color: 'var(--bg)',
                                borderRadius: '10px', fontSize: '0.875rem', fontWeight: 600,
                                textDecoration: 'none'
                            }}>
                                Join the waitlist ‚Üí
                            </a>
                        </div>
                        
                        {/* Reset */}
                        <button
                            onClick={onReset}
                            style={{
                                display: 'block', margin: '1.5rem auto 0',
                                background: 'none', border: 'none',
                                color: 'var(--text-muted)', fontSize: '0.875rem',
                                cursor: 'pointer', textDecoration: 'underline'
                            }}
                        >
                            Start over with different data
                        </button>
                    </div>
                </div>
            );
        };
        
        // ==================== MAIN APP ====================
        const App = () => {
            const [screen, setScreen] = useState('select'); // select, manual, upload, dashboard
            const [financialData, setFinancialData] = useState(null);
            const [insights, setInsights] = useState(null);
            const [prefillData, setPrefillData] = useState(null);
            
            const handleMethodSelect = (method) => {
                if (method === 'demo') {
                    setFinancialData(DEMO_DATA);
                    setInsights(calculateInsights(DEMO_DATA));
                    setScreen('dashboard');
                } else if (method === 'manual') {
                    setScreen('manual');
                } else if (method === 'upload') {
                    setScreen('upload');
                }
            };
            
            const handleManualSubmit = (data) => {
                setFinancialData(data);
                setInsights(calculateInsights(data));
                setScreen('dashboard');
            };
            
            const handleUploadFallback = (parsedData) => {
                if (parsedData) {
                    setPrefillData(parsedData);
                }
                setScreen('manual');
            };
            
            const handleReset = () => {
                setFinancialData(null);
                setInsights(null);
                setPrefillData(null);
                setScreen('select');
            };
            
            const handleBack = () => {
                if (screen === 'manual' || screen === 'upload') {
                    setScreen('select');
                    setPrefillData(null);
                }
            };
            
            return (
                <>
                    <Nav onBack={handleBack} showBack={screen === 'manual' || screen === 'upload'} />
                    
                    {screen === 'select' && (
                        <InputMethodScreen onSelect={handleMethodSelect} />
                    )}
                    
                    {screen === 'manual' && (
                        <ManualInputScreen onSubmit={handleManualSubmit} initialData={prefillData} />
                    )}
                    
                    {screen === 'upload' && (
                        <UploadScreen onSubmit={handleManualSubmit} onManualFallback={handleUploadFallback} />
                    )}
                    
                    {screen === 'dashboard' && (
                        <DashboardScreen data={financialData} insights={insights} onReset={handleReset} />
                    )}
                </>
            );
        };
        
        // Render
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
